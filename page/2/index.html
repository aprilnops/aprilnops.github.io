<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />









  <link rel="alternate" href="/atom.xml" title="Nops Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.2.x" />



<link rel="canonical" href="https://aprilnops.github.io/page/2/"/>


<meta property="og:type" content="website">
<meta property="og:title" content="Nops Blog">
<meta property="og:url" content="https://aprilnops.github.io/page/2/index.html">
<meta property="og:site_name" content="Nops Blog">
<meta property="og:locale" content="zh-cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nops Blog">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.2.x" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />





<script type="text/javascript">
  var themeConfig = {
    search: {
      enable: true,
      path: "/search.xml",
    },
    navbar: {
      enable: true
    },
    fancybox: {
      enable: true
    },
    toc: {
      enable: true
    },
  };
</script>



  



    <title> Nops Blog </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Nops Blog</a>
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              主页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
      
        <li class="menu-search">
          <form>
            <i class="iconfont icon-search" id="open-search"></i>
            <input type="text" class="search-input" id="search-input" />
            <i class="iconfont icon-close" id="close-search"></i>
          </form>
        </li>
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">Nops Blog</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      <a class="mobile-menu-item" href="/">
        
        
          主页
        
      </a>
    
      <a class="mobile-menu-item" href="/tags">
        
        
          标签
        
      </a>
    
      <a class="mobile-menu-item" href="/categories">
        
        
          分类
        
      </a>
    
      <a class="mobile-menu-item" href="/about">
        
        
          关于
        
      </a>
    
      <a class="mobile-menu-item" href="/archives/">
        
        
          归档
        
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  <section id="posts" class="posts">
    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/02/26/opentsdb学习/">opentsdb学习</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年2月26日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h3 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h3><p>tsdb表，存放具体的时间序列数据<br><img src="/images/1480591907962.jpg" alt="tsdb表设计" title="1480591907962.jpg">    </p>
<p>tsdb-uid表，存放metric、tagk、tagv与id之间的映射关系<br><img src="/images/1480591956082.jpg" alt="tsdb-uid" title="1480591956082.jpg"></p>
<p><code>上面这两个图非常重要，必须看懂。</code><br>
          <div class="read-more">
            <a href="/2017/02/26/opentsdb学习/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    
  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/02/26/php参数研究/">php参数研究</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年2月26日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h3 id="部分参数解释"><a href="#部分参数解释" class="headerlink" title="部分参数解释"></a>部分参数解释</h3><ul>
<li>memory_limit<br>限制单个脚本允许分配的最大内存。若整个进程占用的总内存超过这个限制时就会报如下错误：<blockquote>
<p>“Fatal Error： Allowed memory size of xxxxxx bytes exhausted”</p>
</blockquote>
</li>
</ul>
          <div class="read-more">
            <a href="/2017/02/26/php参数研究/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    
  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/02/26/rrdtool原理/">rrdtool原理</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年2月26日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <p>RRD全称是Round Roubin Database，即环形数据库，他是一种循环使用存储空间的数据库，在创建的时候就一定定义好了大小（通过RRA），因此他所创建的数据库大小可控，不会线性增长。(一个rrd文件就是一个数据库文件)</p>
<p>创建一个rrd文件时需要设定以下几个参数：<br>创建 RRD 基本语法</p>
<blockquote>
<p>rrdtool create filename<br>[–start|-b start-time]<br>[–step|-s step]<br>[DS:ds-name:DST:dst-arguments]<br>[RRA:CF:xff:step:rows]</p>
</blockquote>
          <div class="read-more">
            <a href="/2017/02/26/rrdtool原理/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    
  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/02/26/python学习笔记/">python学习笔记</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年2月26日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h3 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h3><p>所有标准对象都可以进行bool判断，以下项的bool判断结果都为false：<br><code>None,false,值为0的数,0,所有的浮点数,空字符串&quot;&quot;,[],{},()</code></p>
<p>python的文件名不能和导入的模块名字相同，否则会报如下错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AttributeError: &apos;module&apos; object has no attribute &apos;xxxx&apos;</span><br></pre></td></tr></table></figure></p>
          <div class="read-more">
            <a href="/2017/02/26/python学习笔记/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    
  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/02/26/基础学习-ss命令/">基础学习-ss命令</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年2月26日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><p>ss [option] [filter]<br><strong>option</strong>:    </p>
<ul>
<li>-V:显示当前ss版本</li>
<li>-n:不解析服务名字(默认端口号可能会被解析为服务的名字）.例如不加n参数，80端口可能显示为http，22端口显示为ssh。</li>
<li>-a 显示所有的连接</li>
<li>-l 仅显示处于listen状态的socket</li>
<li>-o 显示计时器信息，例如timer:(keepalive,24sec,0)</li>
<li><p>-m 显示端口socket内存占用，</p>
<blockquote>
<p>r: represents the read (inbound) buffer<br>w represents the write (outbound) buffer<br>f represents the “forward allocated memory” (memory available to the socket)<br>t represents the transmit queue (stuff waiting to be sent or waiting on an ACK)</p>
          <div class="read-more">
            <a href="/2017/02/26/基础学习-ss命令/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    
  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/02/26/教程-利用aws ec2搭建shadowshocks服务/">教程-利用aws ec2搭建shadowshocks服务</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年2月26日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <h3 id="1-申请一台aws-ec2服务器（可免费使用一年）"><a href="#1-申请一台aws-ec2服务器（可免费使用一年）" class="headerlink" title="1. 申请一台aws ec2服务器（可免费使用一年）"></a>1. 申请一台aws ec2服务器（可免费使用一年）</h3><p>注册完amazon账户后，1申请一台虚拟机并启动。详细过程参考网上教程。这里提别提醒一点网上没有提到的内容：需要打开两个端口，<br> 一个是用于远程ssh登录的22端口,另一个是shadowsocks server所使用的端口号，否则无法使用翻墙功能。如下图所示<br><img src="/images/1479619965462.jpg" alt="入站规则配置" title="1479619965462.jpg"></p>
<p>另外还可以申请一个==弹性IP==，绑定到实例上（aws为避免IP滥用，如果不绑定将会收取一定费用），公有ip在每次重启实例后ip地址会改变，弹性ip的好处是只要绑定到实例上不释放，重启实例ip也不会改变</p>
<h3 id="2-安装shaodowsocks服务端，编写如下配置文件"><a href="#2-安装shaodowsocks服务端，编写如下配置文件" class="headerlink" title="2. 安装shaodowsocks服务端，编写如下配置文件"></a>2. 安装shaodowsocks服务端，编写如下配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/shaodowsocks/config.json</span><br><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</span><br><span class="line">    &quot;server_port&quot;:9999,</span><br><span class="line">    &quot;local_address&quot;:&quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;:8888,</span><br><span class="line">    &quot;password&quot;:&quot;yourpassword&quot;,</span><br><span class="line">    &quot;timeout&quot;:600,</span><br><span class="line">    &quot;method&quot;:&quot;aes-256-cfb&quot;,</span><br><span class="line">    &quot;fast_open&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-启动shadowsocks服务器"><a href="#3-启动shadowsocks服务器" class="headerlink" title="3.启动shadowsocks服务器"></a>3.启动shadowsocks服务器</h3><h3 id="4-配置客户端访问"><a href="#4-配置客户端访问" class="headerlink" title="4.配置客户端访问"></a>4.配置客户端访问</h3>
        
      
    </div>

    

    
  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/01/26/docker mtu介绍/">docker mtu介绍</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年1月26日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <p><strong>本文所述内容是针对旧版本docker（doker 1.10版本以下不包括1.10版本）</strong></p>
<h3 id="docker-mtu"><a href="#docker-mtu" class="headerlink" title="docker mtu"></a>docker mtu</h3><blockquote>
<p>By default, the Docker server creates and configures the host system’s docker0 interface as an Ethernet bridge inside the Linux kernel that can pass packets back and forth between other physical or virtual network interfaces so that they behave as a single Ethernet network.</p>
</blockquote>
<p>==启动docker时==,docker服务器会在内核中创建一个docker0网卡接口作为网桥，通过此网桥，虚拟网卡和物理网卡之间可以互相传输数据包。</p>
<blockquote>
<p>Docker configures docker0 with an IP address, netmask and IP allocation range. The host machine can both receive and send packets to containers connected to the bridge, and gives it an MTU – the maximum transmission unit or largest packet length that the interface will allow – of either 1,500 bytes or else a more specific value copied from the Docker host’s interface that supports its default route. These options are configurable at server startup:</p>
</blockquote>
<p>具体的，docker会为docker0配置一个IP地址、子网掩码和ip地址池，物理机可以与连接到docker0的任何容器传输数据。同时设置docker0的mtu值为1500或者宿主机默认网卡的mtu值（==docker1.10以下版本==）。这些工作在docker启动时进行。</p>
<blockquote>
<p>Once you have one or more containers up and running, you can confirm that Docker has properly connected them to the docker0 bridge by running the brctl command on the host machine and looking at the interfaces column of the output. Here is a host with two different containers connected:</p>
</blockquote>
<p>一旦启动一个容器，docker便会将这个容器连接到docker0上。可通过<code>sudo brctl show</code>命令查看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo brctl show</span><br><span class="line">bridge name     bridge id               STP enabled     interfaces</span><br><span class="line">docker0         8000.3a1d7362b4ee       no              veth65f9</span><br><span class="line">                                                        vethdda6</span><br></pre></td></tr></table></figure></p>
          <div class="read-more">
            <a href="/2017/01/26/docker mtu介绍/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    
  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/12/20/TCP分片机制介绍/">TCP分片机制介绍</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2016年12月20日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h3 id="MTU，MSS概念"><a href="#MTU，MSS概念" class="headerlink" title="MTU，MSS概念"></a>MTU，MSS概念</h3><h4 id="tcp帧"><a href="#tcp帧" class="headerlink" title="tcp帧"></a>tcp帧</h4><p>tcp协议规定的帧长度如下如所示<br><img src="/images/1479730513156.jpg" alt="tcp协议帧结构" title="tcp帧结构.jpg"><br>通常情况下各个帧长度如下：<br>以太网帧：1518bytes<br>网卡MTU：1500bytes<br>TCP最大段：1460bytes<br>数据在网络中传输时，长度大于MTU的包会被IP层分片传输，到达目的地后再中心组装成一个完整的包。但是ip分片存在着严重的性能问题：</p>
<ul>
<li>影响效率，消耗cpu和内存，server，router，and client都会进行分片</li>
<li>一个ip分片丢失将导致整个TCP数据包重传（ip层提供不可靠服务，无法知晓哪个分片丢失）</li>
</ul>
<p>因此TCP协议在TCP层，利用MSS避免数据分片问题。具体方法是：</p>
<blockquote>
<p>通信双方进行三次握手传递SYN包时，将自己的最大MSS值（根据MTU值计算）写在header中，传递给对方。最终双方将选取一个最小的MSS值作为TCP层可发送的最大数据长度。这个过程叫做MSS协商</p>
</blockquote>
<p>TCP的MSS只能保证通信的两端数据不会被分片，无法保证整个传输路径中数据不被分片，例如网络中的路由器。PMTUD就是为了解决这个问题的。<br>
          <div class="read-more">
            <a href="/2016/12/20/TCP分片机制介绍/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    
  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/10/25/openfalcon架构梳理/">open-falcon架构介绍</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2016年10月25日
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <p>本文主要对open-falcon的整体架构及各个主要组件进行详细的介绍。</p>
          <div class="read-more">
            <a href="/2016/10/25/openfalcon架构梳理/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    
  </article>

    
  </section>

  
  <nav class="pagination">
    
      <a class="prev" href="/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">上一页</span>
      </a>
    
    
  </nav>


          </div>
          
        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:zkwhu@@foxmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/aprilnops" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2016 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Nops</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    


    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/even.js?v=2.2.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.2.x"></script>

  </body>
</html>